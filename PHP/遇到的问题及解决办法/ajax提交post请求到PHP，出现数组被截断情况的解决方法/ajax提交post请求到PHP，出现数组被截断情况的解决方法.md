# ajax提交post请求到PHP，出现数组被截断情况的解决方法



## 一、场景

Ajax 提交 POST 请求时传的数据是数组，没有把数据进行序列化处理或者转换成Json格式，直接传送的是数组格式，然后突然有次发现，当数组中的键值对比较多时，前端数据传到服务端，数组中部分数据丢失。



## 二、解决过程

经过调试发现前端提交post请求时数组中的数据量是正确的，但到服务端只能接受到1000条左右（可能是算法问题，导致不值精准的1000条）。

开始想到是不是因为POST发送的数据过长，导致浏览器或者php.ini中对POST的限制长度给截断了。

但是查看了数据量的大小才200多K，显然不是因为这个原因。而且最重要的是数组中的数据是完整的部分缺失，而不是像字符串过长时从后到前直接截断。

于是怀疑是不是参数个数限制置导致的，于是将数组变成json后传递到后台，果然就解决了这该问题。后来搜索了下果不其然发现max_input_vars这个配置项，该配置项是在php 5.3.9版本之后才加入的，目的是为了防止hash冲突。

既然如此那就改下该配置项，默认是1000，改成10000，或者更高。

然而前端传的数据量是不确定的，就算把max_input_vars设置成10万，也有可能不够用。

 

## 三、最终解决方法

1、前端将数组转换成json传输，即通过JSON.stringify(param)

2、服务端接收到并解析\$param= json_decode($_POST['param'], true);

3、测试发现前端传过来的数据服务端都能获取到，问题圆满解决